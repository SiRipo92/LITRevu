{% extends "base.html" %}
{% block title %}Mes Posts{% endblock %}

{% block content %}
<h1 class="text-blue-600 text-2xl font-semibold text-center w-full mb-8">
    Mes Posts
</h1>

<div class="space-y-8 max-w-3xl mx-auto px-4">

    <!-- === User Tickets === -->
    {% for ticket in tickets %}
    <article class="border rounded-lg p-6 shadow-sm bg-white">
        <div class="flex justify-between text-sm text-gray-600 mb-2">
            <p>Vous avez demandé une critique</p>
            <p>{{ ticket.time_created|date:"H:i, d F Y" }}</p>
        </div>

        <h2 class="text-lg font-semibold text-gray-900 mb-2">{{ ticket.title }}</h2>

        {% if ticket.description %}
          <p class="text-gray-800 mb-3">{{ ticket.description }}</p>
        {% endif %}

        {% if ticket.image %}
          <img src="{{ ticket.image.url }}" alt="Image associée"
               class="max-h-64 rounded mb-4">
        {% endif %}

        <!-- Buttons -->
        <div class="flex justify-end gap-4">
            <a href="{% url 'reviews:edit_ticket' ticket.id %}"
               class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">
               Modifier
            </a>
            <a href="{% url 'reviews:delete_ticket' ticket.id %}"
               class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition">
               Supprimer
            </a>
        </div>
    </article>
    {% empty %}
        <p class="text-gray-500 italic text-center">Aucun ticket créé pour le moment.</p>
    {% endfor %}

    <!-- === User Reviews === -->
    {% if reviews %}
    <h2 class="text-blue-600 text-xl font-semibold mt-12 mb-4">Vos critiques</h2>
    {% for review in reviews %}
    <article class="border rounded-lg p-6 shadow-sm bg-gray-50">
        <div class="flex justify-between text-sm text-gray-600 mb-2">
            <p>Votre critique en réponse à "{{ review.ticket.title }}"</p>
            <p>{{ review.time_created|date:"H:i, d F Y" }}</p>
        </div>

        <h3 class="text-lg font-semibold text-gray-900 mb-2">{{ review.headline }}</h3>
        <p class="text-gray-800 mb-3">{{ review.body }}</p>

        <div class="flex justify-end gap-4">
            <a href="{% url 'reviews:edit_review' review.id %}"
               class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">
               Modifier
            </a>
            <a href="{% url 'reviews:delete_review' review.id %}"
               class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition">
               Supprimer
            </a>
        </div>
    </article>
    {% endfor %}
    {% endif %}

</div>
{% endblock %}